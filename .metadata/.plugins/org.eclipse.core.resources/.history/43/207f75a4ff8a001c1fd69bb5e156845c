package com.abhisek.mindtree.repository;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Modifying;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;

import com.abhisek.mindtree.model.Cart;

import javax.transaction.Transactional;
import java.util.List;

public interface CartRepository extends JpaRepository<Cart, Integer> {
	@Query("select c from Cart c where c.userId=:userId ")
	public List<Cart> findAllCartItems(@Param("userId") long userId);

	@Query("select case when count(c)> 0 then true else false end from Cart c where  c.userId=:userId  and :productId = c.productId")
	boolean existsCartItemCustomQuery(@Param("userId") long id, @Param("productId") int productId);

	@Query("select c from Cart c where c.userId=:userId and c.productId = :productId")
	public Cart findCartItem(@Param("userId") long id, @Param("productId") int productId);

	@Transactional
	@Modifying
	@Query("delete from Cart c where c.userId=:userId  and c.productId = :productId")
	public Cart deleteCartItem(@Param("userId") long userId, @Param("productId") int productId);

}
